/home/ptossou/env/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Traceback (most recent call last):
  File "main.py", line 276, in <module>
    comparison_expts(**param, expts_dir='expts_helios', fit=True)
  File "main.py", line 134, in comparison_expts
    scores = metalearner.evaluate(meta_test, **p)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/pretraining_baseline.py", line 53, in evaluate
    learners = [self.fine_tune(*episode['Dtrain'], lr, n_epochs) for episode in batch]
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/pretraining_baseline.py", line 53, in <listcomp>
    learners = [self.fine_tune(*episode['Dtrain'], lr, n_epochs) for episode in batch]
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/pretraining_baseline.py", line 45, in fine_tune
    model.fit_generator(gen, gen, n_epochs=n_epochs, steps_per_epoch=1)
  File "/home/ptossou/env/lib/python3.5/site-packages/pytoune/framework/model.py", line 41, in fit_generator
    loss_tensor, metrics_tensors = self._run_step(train_iterator)
  File "/home/ptossou/env/lib/python3.5/site-packages/pytoune/framework/model.py", line 103, in _run_step
    return self._compute_loss_and_metrics(x, y)
  File "/home/ptossou/env/lib/python3.5/site-packages/pytoune/framework/model.py", line 108, in _compute_loss_and_metrics
    pred_y = self.model(x)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/modules.py", line 224, in forward
    return self.net(x)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/container.py", line 67, in forward
    input = module(input)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/modules.py", line 132, in forward
    return self.net(x)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/container.py", line 67, in forward
    input = module(input)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/modules.py", line 90, in forward
    y = self.net(x_new.float())
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/linear.py", line 55, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/functional.py", line 835, in linear
    return torch.addmm(bias, input, weight.t())
RuntimeError: Expected object of type Variable[torch.FloatTensor] but found type Variable[torch.cuda.FloatTensor] for argument #1 'mat1'

==============NVSMI LOG==============

Timestamp                           : Fri Feb 16 23:09:07 2018
Driver Version                      : 384.111

Attached GPUs                       : 16
GPU 00000000:06:00.0
    Accounting Mode                 : Enabled
    Accounting Mode Buffer Size     : 1920
    Accounted Processes
        Process ID                  : 6699
            GPU Utilization         : 8 %
            Memory Utilization      : 3 %
            Max memory usage        : 0 MiB
            Time                    : 53571 ms
            Is Running              : 0
        Process ID                  : 213986
            GPU Utilization         : 9 %
            Memory Utilization      : 3 %
            Max memory usage        : 655 MiB
            Time                    : 54007 ms
            Is Running              : 0

/home/ptossou/env/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

==============NVSMI LOG==============

Timestamp                           : Sun Feb 18 10:30:00 2018
Driver Version                      : 384.111

Attached GPUs                       : 16
GPU 00000000:07:00.0
    Accounting Mode                 : Enabled
    Accounting Mode Buffer Size     : 1920
    Accounted Processes             : None

