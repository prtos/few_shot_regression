/home/ptossou/env/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Traceback (most recent call last):
  File "main.py", line 276, in <module>
    comparison_expts(**param, expts_dir='expts_helios', fit=True)
  File "main.py", line 121, in comparison_expts
    log_filename=log_fname, checkpoint_filename=ckp_fname)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/maml.py", line 90, in fit
    return super(MAML, self).fit(metatrain, metavalid, n_epochs, steps_per_epoch, log_filename, checkpoint_filename)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/base.py", line 44, in fit
    callbacks=callbacks)
  File "/home/ptossou/env/lib/python3.5/site-packages/pytoune/framework/model.py", line 300, in fit_generator
    x, y = next(train_iterator)
ValueError: too many values to unpack (expected 2)

==============NVSMI LOG==============

Timestamp                           : Fri Feb 23 23:19:39 2018
Driver Version                      : 384.111

Attached GPUs                       : 16
GPU 00000000:89:00.0
    Accounting Mode                 : Enabled
    Accounting Mode Buffer Size     : 1920
    Accounted Processes             : None

THCudaCheck FAIL file=/pytorch/torch/lib/THC/generic/THCStorage.cu line=58 error=2 : out of memory
/home/ptossou/env/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
Traceback (most recent call last):
  File "main.py", line 276, in <module>
    comparison_expts(**param, expts_dir='expts_helios', fit=True)
  File "main.py", line 126, in comparison_expts
    scores = metalearner.evaluate(meta_test)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/maml.py", line 101, in evaluate
    y_pred = learner(x_test)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/modules.py", line 224, in forward
    return self.net(x)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/container.py", line 67, in forward
    input = module(input)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/nne-790-aa/ptossou/few_shot_regression/models/modules.py", line 132, in forward
    return self.net(x)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/container.py", line 67, in forward
    input = module(input)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/module.py", line 325, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/modules/conv.py", line 166, in forward
    self.padding, self.dilation, self.groups)
  File "/home/ptossou/env/lib/python3.5/site-packages/torch/nn/functional.py", line 54, in conv1d
    return f(input, weight, bias)
RuntimeError: cuda runtime error (2) : out of memory at /pytorch/torch/lib/THC/generic/THCStorage.cu:58

==============NVSMI LOG==============

Timestamp                           : Sat Feb 24 19:08:15 2018
Driver Version                      : 384.111

Attached GPUs                       : 16
GPU 00000000:06:00.0
    Accounting Mode                 : Enabled
    Accounting Mode Buffer Size     : 1920
    Accounted Processes
        Process ID                  : 8538
            GPU Utilization         : 39 %
            Memory Utilization      : 15 %
            Max memory usage        : 0 MiB
            Time                    : 4913625 ms
            Is Running              : 0
        Process ID                  : 38847
            GPU Utilization         : 40 %
            Memory Utilization      : 16 %
            Max memory usage        : 10446 MiB
            Time                    : 4914578 ms
            Is Running              : 0

